SELECT 
    p.NAMA AS NAMA_PELANGGAN,
    COUNT(*) AS JUMLAH,
    SUM(t.JUMLAH_BARANG * b.HARGA_SATUAN) AS TOTAL_HARGA
FROM 
    transaksi t
INNER JOIN pelanggan p ON t.KODE_PELANGGAN = p.KODE_PELANGGAN
INNER JOIN barang b ON t.KODE_BARANG = b.KODE_BARANG
GROUP BY p.NAMA;